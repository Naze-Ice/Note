## 分布式锁

Redis做分布式锁的问题

- 死锁：如果解锁时删除键失败，将陷入死锁，所以锁必须设置过期时间，且设置锁和过期时间的操作必须具有原子性

  > Redis2.8以后加入了set的参数设置nx和ex，相当于setnx和expire组合在一起的原子操作

- 超时：锁过期后

  > 可通过给value设置随机值，删除先判断valueLUA脚本

- 可重入性：